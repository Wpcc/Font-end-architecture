<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title></title>
	</head>
	<body>
	</body>
	<script>
		const state = {
			count:0
		}
		function update(){
			console.log(state.count) 
		}
		// 这个时候呢，我们就可以认为update依赖于state.count这个值
		
		function isObject(obj){
			return typeof obj == 'object'
			&& !Array.isArray(obj)
			&& obj != null
			&& obj != undefined
		}
		function observer(obj){
			// 1.判断参数是否为一个对象
			if(!isObject){
				// 抛出类型错误
				throw new TypeError()
			}
			// 2.遍历这个对象的所有参数
			Object.keys(obj).forEach(key => {
				// 3.改写每个对象参数的读取和写入，也就是get和set函数
				let internalValue = obj[key]
				Object.defineProperty(obj,key,{
					get(){
						console.log('读取的值：' + internalValue)
						return internalValue
					},
					set(newValue){
						console.log('写入的值：' + newValue)
						internalValue = newValue
					}
				})
			})
		}
		
		observer(state)
		
		state.count++
	</script>
</html>
