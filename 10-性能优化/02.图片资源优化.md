# 图片资源优化

### 为什么要优化图片

- 首先来看一个名为HTTP-Archive的网站

  - 这个网站会定期抓取Web上的站点，并记录资源的加载情况、Web API 的使用情况等页面的详细信息。
  - 以一年为例，我们来查看2019年~2010年，平均每次资源请求的传输大小。
  - 总的Web资源平均请求体积
  - ![01](C:\Users\mi\Desktop\前端知识整理\前端性能优化\img03\01.png)

  - 图片类资源的平均请求体积
  - ![02](C:\Users\mi\Desktop\前端知识整理\前端性能优化\img03\02.png)

**可以看到图片类资源几乎占据着Web资源的一半，这就是为什么要优化图片。**

### 图片的种类

- JPG（JPEG）
  - 介绍
    - JPG最大的特点是**有损压缩**。它用有损压缩的方式去除冗余的图像和彩色数据，在获得极高的压缩率的同时又能展现丰富生动的图像，让较少的磁盘容量展现较好的图片质量。
  - 优点
    - 体积小、高质量、有损压缩（将体积压缩到50%，图片依旧能保持住60%的品质）
  - 缺点
    - **有损压缩**让JPG天然无法处理**矢量图**和**Logo**等线条感强、颜色对比强烈的图像。
    - JPG不支持**透明度处理**
  - 适用场景
    - 背景图、轮播图或banner图（可参考各大电商网站）
- PNG（PNG8、PNG24）
  - 介绍
    - PNG是一种**无损压缩**的位图片格式，其设计目的是试图替代GIF和TIFF文件格式，同时增加一些GIF文件格式所不具备的特征。
    - PNG后缀中的 8 和 24 代表着二进制的位数，即PNG8最多支持256种颜色，而PNG24可以支持约1600万种颜色。
  - 优点
    - PNG支持**透明度处理**
    - 色彩表现力、对线条处理能力比JPG更强
  - 缺点
    - 体积大
  - 适用场景
    - Logo或一些需要用到高品质质量的图片（参考各大电商网站）
- GIF
  - 介绍
    - GIF全称是Graphics Interchange Format，译为图形交换格式，主要用来表示动图
  - 优点
    - 支持动态图
  - 缺点
    - 体积大
  - 适用场景
    - 抓住用户眼球，广告图。
- Base64
  - 介绍
    - Base64是一种用于传输8Bit字节码的编码方式，通过对图片进行Base64编码，可以直接将编码结果写入HTML或者写入CSS，从而减少HTTP请求次数。
  - 优点
    - 减少HTTP请求
  - 缺点
    - 图片大小会膨胀为源文件的4/3大小（由Base64的编码原理决定）
    - 图片更新麻烦（不适合频繁更新的图片）
  - 适用场景
    - 小图标或小logo（大小控制在2K内）
- SVG
  - 介绍
    - SVG（可缩放矢量图形）是一种基于XML语法的图像格式。它和本文提及的其它图片种类有着本质不同：SVG对图像的处理不是基于像素点，而是基于对图像的形状描述。
  - 优点
    - 体积小，压缩性强（相比JPG、PNG）
    - 放大不失真
  - 缺点
    - 浏览器渲染成本高
    - 有额外的学习成本
    - 兼容性（IE9）
  - 使用场景
    - 图标（兼容性不高或移动端）
  - 使用方式
    - 直接在页面上使用
    - 放在symbol中，在页面需要地方引用
    - 阿里Iconfont中Symbol的使用，是用JS在页面头部生出symbol，随后在需要的地方引用。

### Iconfont

**阿里巴巴提供的一个矢量图标库，除了提供PNG，JPG格式之外，还提供另外三种使用方式：**

- Unicode
  - 本质上使用的自定义字体（@font-face）
  - 兼容性最好，支持IE6
  - 不支持多色
- Font-class
  - 本质上使用的是自定义字体（@font-face）
  - 兼容性良好，支持IE8+
  - 不支持多色
  - 语义明确，书写更直观
- Symbol
  - 本质上使用的是SVG
  - 支持多色
  - 兼容性差（IE9+）
  - 浏览器渲染SVG的性能差，不如PNG

具体学习方式：

- 通过本地code代码iconfont
- 下载iconfont字体，demo中有三种方式的使用说明

### 优化方向

- 减少http请求
  - 雪碧图
  - Base64
- 减小图片大小
  - JPG 
    - 可以使用PS去调整图片品质
  - PNG
    - 使用pngcrush进行压缩
  - GIF
    - 使用ImageMagick（将GIF转换成PNG）
    - 动图  -->  减小帧率
  - 小于2K的logo图片
    - 不考虑兼容使用Iconfont
    - 不经常替换使用Base64

